# 使用内联 RISCV 汇编实现整数数组求和

## 题目介绍

本题目要求参与者编写一个C语言函数 `calculate_sum`，该函数使用内联RISC-V汇编来计算一个整数数组中所有元素的和。然后，编写一个程序调用该函数并输出结果。

本题可参考[第六章 RISC-V架构内联汇编](../chapter-6.md)全部小节内容。

## 题目要求

- 实现一个C语言函数 `calculate_sum`，使用内联RISC-V汇编。
- 函数接受一个整数数组 `arr` 和数组的长度 `n`。
- 计算并返回数组中所有元素的和。

## 输入

- 一个整数数组 `arr`，以逗号分隔，例如 `1,2,3,4,5`。
- 一个整数 `n`，表示数组的长度。

## 输出

- 按照格式 `Sum of array elements is result` 输出，其中 `result` 是数组中所有元素的和。

## 示例

- 如果输入数组是 `1,2,3,4,5` 且 `n = 5`，则输出应该是 `Sum of array elements is 15`。

## 代码介绍

1. **main.c** 文件包含了主函数和 `calculate_sum` 函数的C包装器。
   - `main` 函数处理命令行参数，解析数组字符串，并调用 `calculate_sum` 函数打印结果。
   - `calculate_sum` 函数使用内联汇编实现，其中包含了多个PLACEHOLDER，需要用正确的RISC-V汇编指令替换。

2. 内联汇编使用GCC的扩展语法，其中：
   - `"li"` 指令用于将立即数加载到寄存器。
   - `"lw"` 指令用于从内存加载值到寄存器。
   - `"addi"` 指令用于将一个立即数加到寄存器。
   - `"add"` 指令用于将两个寄存器的值相加。
   - `"mv"` 指令用于将一个寄存器的值移动到另一个寄存器。
   - `"bge"` 指令用于比较两个寄存器，并在第一个大于等于第二个时跳转。

## 详细提示信息

- **内联汇编替换**：
  - 使用RISC-V汇编指令替换 `calculate_sum` 函数中的PLACEHOLDER。
  - 对于循环结束条件，使用 `"bge"` 指令比较索引寄存器 `t0` 和 `n` 寄存器。
  - 使用 `"lw"` 从数组中加载元素到临时寄存器 `t2`。
  - 使用 `"add"` 将 `t2` 的值累加到 `result` 寄存器 `t1`。
  - 使用 `"addi"` 将数组指针 `arr` 的地址递增以指向下一个元素。

- **数组解析**：
  - 在 `main` 函数中，使用 `strtok` 函数解析逗号分隔的数组字符串。

- **错误处理**：
  - 检查命令行参数的数量和格式。
  - 确保输入的数组元素数量与 `n` 匹配。

- **编译与测试**：
  - 使用 `gcc` 编译器编译程序，并确保RISC-V汇编语法正确。

## 注意事项

- 确保替换的汇编指令逻辑正确，能够正确计算数组的和。
- 注意内联汇编的语法和寄存器使用。
- 确保程序能够正确处理命令行参数和数组解析。
- 参与者需要根据题目要求，使用RISC-V汇编语言完成数组求和的计算。通过这个练习，可以加深对RISC-V汇编语言和内联汇编使用的理解，并掌握如何在C语言中嵌入汇编代码来优化性能关键部分。
